{"ast":null,"code":"import _objectSpread from\"/Users/juanlugo/Desktop/sp-firebase/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/juanlugo/Desktop/sp-firebase/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/juanlugo/Desktop/sp-firebase/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/juanlugo/Desktop/sp-firebase/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{lazy,Suspense,useEffect,useState}from\"react\";// React Router\nimport{Switch,Route,Redirect}from'react-router-dom';// IdleTimerContainer\nimport IdleTimerContainer from'./components/IdleTimerContainer/IdleTimerContainer';// Firebase\nimport{auth,createUserProfileDocument}from'./firebase/firebase';// Components\nimport Overlay from'./components/Overlay/Overlay';// Pages\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=/*#__PURE__*/lazy(function(){return import('../src/pages/HomePage/Home');});var Login=/*#__PURE__*/lazy(function(){return import('../src/pages/LoginPage/Login');});function App(){/**-- States --*/var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isAuthenticated=_useState2[0],setIsAuthenticated=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],updateIsLoading=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),userInfo=_useState6[0],updateUserInfo=_useState6[1];useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return auth.onAuthStateChanged(function(user){if(user){// console.log('is logged');\n// Create User profile\ncreateUserProfileDocument(user);// Update states\n// Update states\nupdateIsLoading(false);updateUserInfo(user);setIsAuthenticated(true);}else{// console.log('is not logged');\n// setIsAuthenticated\nsetIsAuthenticated(false);// updateIsLoading\n// updateIsLoading\nupdateIsLoading(false);}});case 2:case\"end\":return _context.stop();}}},_callee);}))();},[]);if(isLoading){return/*#__PURE__*/_jsx(Overlay,{text:'Checking the session...',spinner:true});}return/*#__PURE__*/_jsx(Switch,{children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(Overlay,{text:'Loading data, please wait...',spinner:true}),children:isAuthenticated?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Route,{path:\"/home\",render:function render(props){return/*#__PURE__*/_jsx(Home,_objectSpread({user:userInfo},props));}}),/*#__PURE__*/_jsx(IdleTimerContainer,{}),/*#__PURE__*/_jsx(Redirect,{to:\"/home\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",component:Login}),/*#__PURE__*/_jsx(Redirect,{to:\"/\"})]})})});}export default App;","map":{"version":3,"sources":["/Users/juanlugo/Desktop/sp-firebase/src/App.jsx"],"names":["React","lazy","Suspense","useEffect","useState","Switch","Route","Redirect","IdleTimerContainer","auth","createUserProfileDocument","Overlay","Home","Login","App","isAuthenticated","setIsAuthenticated","isLoading","updateIsLoading","userInfo","updateUserInfo","onAuthStateChanged","user","props"],"mappings":"omBAAA,MAAOA,CAAAA,KAAP,EAAgBC,IAAhB,CAAsBC,QAAtB,CAAgCC,SAAhC,CAA2CC,QAA3C,KAA2D,OAA3D,CACA;AACA,OAASC,MAAT,CAAiBC,KAAjB,CAAwBC,QAAxB,KAAwC,kBAAxC,CACA;AACA,MAAOC,CAAAA,kBAAP,KAA+B,oDAA/B,CACA;AACA,OAASC,IAAT,CAAeC,yBAAf,KAAgD,qBAAhD,CAEA;AACA,MAAOC,CAAAA,OAAP,KAAoB,8BAApB,CAEA;6IACA,GAAMC,CAAAA,IAAI,cAAGX,IAAI,CAAC,iBAAM,QAAO,4BAAP,CAAN,EAAD,CAAjB,CACA,GAAMY,CAAAA,KAAK,cAAGZ,IAAI,CAAC,iBAAM,QAAO,8BAAP,CAAN,EAAD,CAAlB,CAEA,QAASa,CAAAA,GAAT,EAAe,CAEb,iBACA,cAA8CV,QAAQ,CAAC,KAAD,CAAtD,wCAAOW,eAAP,eAAwBC,kBAAxB,eACA,eAAqCZ,QAAQ,CAAC,IAAD,CAA7C,yCAAOa,SAAP,eAAkBC,eAAlB,eACA,eAAmCd,QAAQ,CAAC,IAAD,CAA3C,yCAAOe,QAAP,eAAiBC,cAAjB,eAEAjB,SAAS,CAAC,UAAM,CACd,wDAAC,yJAEOM,CAAAA,IAAI,CAACY,kBAAL,CAAwB,SAACC,IAAD,CAAU,CACtC,GAAIA,IAAJ,CAAU,CACR;AAEA;AACAZ,yBAAyB,CAACY,IAAD,CAAzB,CACA;AAAA;AACAJ,eAAe,CAAC,KAAD,CAAf,CACAE,cAAc,CAACE,IAAD,CAAd,CACAN,kBAAkB,CAAC,IAAD,CAAlB,CACD,CATD,IASO,CACL;AACA;AACAA,kBAAkB,CAAC,KAAD,CAAlB,CACA;AAAA;AACAE,eAAe,CAAC,KAAD,CAAf,CACD,CACF,CAjBK,CAFP,uDAAD,KAqBD,CAtBQ,CAsBN,EAtBM,CAAT,CAwBA,GAAID,SAAJ,CAAe,CACb,mBAAO,KAAC,OAAD,EAAS,IAAI,CAAE,yBAAf,CAA0C,OAAO,CAAE,IAAnD,EAAP,CACD,CAED,mBACI,KAAC,MAAD,wBACE,KAAC,QAAD,EAAU,QAAQ,cAAE,KAAC,OAAD,EAAS,IAAI,CAAE,8BAAf,CAA+C,OAAO,CAAE,IAAxD,EAApB,UACGF,eAAe,cAEZ,wCACE,KAAC,KAAD,EAAO,IAAI,CAAC,OAAZ,CAAoB,MAAM,CAAE,gBAACQ,KAAD,qBAAW,KAAC,IAAD,gBAAM,IAAI,CAAEJ,QAAZ,EAA0BI,KAA1B,EAAX,EAA5B,EADF,cAGE,KAAC,kBAAD,IAHF,cAKE,KAAC,QAAD,EAAU,EAAE,QAAZ,EALF,GAFY,cAYZ,wCACE,KAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,IAAI,CAAC,GAAlB,CAAsB,SAAS,CAAEV,KAAjC,EADF,cAGE,KAAC,QAAD,EAAU,EAAE,CAAC,GAAb,EAHF,GAbN,EADF,EADJ,CAyBD,CAED,cAAeC,CAAAA,GAAf","sourcesContent":["import React, { lazy, Suspense, useEffect, useState } from \"react\";\n// React Router\nimport { Switch, Route, Redirect } from 'react-router-dom';\n// IdleTimerContainer\nimport IdleTimerContainer from './components/IdleTimerContainer/IdleTimerContainer';\n// Firebase\nimport { auth, createUserProfileDocument } from './firebase/firebase';\n\n// Components\nimport Overlay from './components/Overlay/Overlay';\n\n// Pages\nconst Home = lazy(() => import('../src/pages/HomePage/Home'));\nconst Login = lazy(() => import('../src/pages/LoginPage/Login'));\n\nfunction App() {\n  \n  /**-- States --*/\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, updateIsLoading] = useState(true);\n  const [userInfo, updateUserInfo] = useState(null);\n\n  useEffect(() => {\n    (async () => {\n      // Session\n      await auth.onAuthStateChanged((user) => {\n        if (user) {\n          // console.log('is logged');\n\n          // Create User profile\n          createUserProfileDocument(user);\n          // Update states\n          updateIsLoading(false);\n          updateUserInfo(user);\n          setIsAuthenticated(true);\n        } else {\n          // console.log('is not logged');\n          // setIsAuthenticated\n          setIsAuthenticated(false);\n          // updateIsLoading\n          updateIsLoading(false);\n        }\n      });\n    })();\n  }, []);\n\n  if (isLoading) {\n    return <Overlay text={'Checking the session...'} spinner={true} />\n  }\n  \n  return (\n      <Switch>\n        <Suspense fallback={<Overlay text={'Loading data, please wait...'} spinner={true} />}>\n          {isAuthenticated ?\n            (\n              <>\n                <Route path='/home' render={(props) => <Home user={userInfo} {...props} />} />\n                {/* Checking activity */}\n                <IdleTimerContainer />\n                {/* Redirect */}\n                <Redirect to={`/home`} />\n              </>\n            )\n            :\n            (\n              <>\n                <Route exact path='/' component={Login} />\n                {/* Redirect */}\n                <Redirect to=\"/\" /> \n              </>\n            )\n          }\n        </Suspense>\n      </Switch>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}